var model={init:function(){$("body").append('<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&signed_in=true&key=AIzaSyD-ea-0b-EOXWC6svLpOyxcBKs3ecfe1co&callback=model.loadMap">')},loadMap:function(){function e(e,a){if(a==google.maps.places.PlacesServiceStatus.OK)for(var s=0;s<e.length;s++){var n=e[s];model.places.push(n);{e[s].place_id}o(e[s])}}function o(e){var o=e.geometry.location,a=e.photos?e.photos[0].getUrl({maxWidth:200,maxHeight:200}):"images/sample.jpg",s=new google.maps.Marker({map:l(),position:o,title:e.name}),n=new google.maps.InfoWindow({content:'<h4 class="text-center">'+e.name+'</h4><img src="'+a+'" class="img-responsive">'});google.maps.event.addListener(s,"click",function(){n.open(l(),this)})}var a=ko.observable(40.8621822),s=ko.observable(-73.8935974),n=ko.observable(new google.maps.LatLng(a(),s())),l=ko.observable(new google.maps.Map(document.getElementById("mapCanvas"),{center:n(),zoom:17})),t={location:n(),radius:"500",types:["store"]},p=new google.maps.places.PlacesService(l());p.nearbySearch(t,e);var c=document.getElementById("search"),g=new google.maps.LatLngBounds(new google.maps.LatLng(40.8621822,-73.8935974),new google.maps.LatLng(40.8621822,-73.8935974)),i=new google.maps.places.SearchBox(c,{bounds:g});google.maps.event.addListener(i,"places_changed",function(){var e=i.getPlaces();model.places.push(e[0]),console.log(e),0!=e.length&&o(e[0])}),model.map=l()},places:ko.observableArray([]),map:ko.observable()},ViewModel=function(){var e=this;e.map=ko.observable(model.init()),e.places=ko.computed(function(){return model.places()})};ko.applyBindings(new ViewModel);