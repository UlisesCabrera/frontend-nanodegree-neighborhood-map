var map,neighborhood,model={loadMap:function(){function e(e,o){if(o==google.maps.places.PlacesServiceStatus.OK)for(var a=0;a<e.length;a++)vm.places.push(e[a]),vm.createMarker(vm.places()[a])}neighborhood=ko.computed(function(){return new google.maps.LatLng(vm.lat(),vm.lng())}),map=ko.observable(new google.maps.Map(document.getElementById("mapCanvas"),{center:neighborhood(),zoom:17}));var o={location:neighborhood(),radius:"500",types:["store"]},a=new google.maps.places.PlacesService(map());a.nearbySearch(o,e)}},ViewModel=function(){var e=this;e.lat=ko.observable(40.8621822),e.lng=ko.observable(-73.8935974),e.init=function(){$("body").append('<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&signed_in=true&key=AIzaSyD-ea-0b-EOXWC6svLpOyxcBKs3ecfe1co&callback=model.loadMap">')},e.places=ko.observableArray([]),e.createMarker=function(e){var o=e.geometry.location,a=e.photos?e.photos[0].getUrl({maxWidth:200,maxHeight:200}):"images/sample.jpg",n=new google.maps.Marker({map:map(),position:o,title:e.name}),s=new google.maps.InfoWindow({content:'<h4 class="text-center">'+e.name+'</h4><img src="'+a+'" class="img-responsive">'});google.maps.event.addListener(n,"click",function(){s.open(map(),this)})},e.init()},vm=new ViewModel;ko.applyBindings(vm);