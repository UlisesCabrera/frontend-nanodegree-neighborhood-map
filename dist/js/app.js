var model={init:function(){$("body").append('<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&signed_in=true&key=AIzaSyD-ea-0b-EOXWC6svLpOyxcBKs3ecfe1co&callback=model.loadMap">')},loadMap:function(){function e(e,a){if(a==google.maps.places.PlacesServiceStatus.OK)for(var s=0;s<e.length;s++){var l=e[s];console.log(l),model.places.push(l);{e[s].place_id}o(e[s])}}function o(e){var o=(e.geometry.location,e.photos?e.photos[0].getUrl({maxWidth:200,maxHeight:200}):"images/sample.jpg");console.log(o);var a=new google.maps.Marker({map:n(),position:e.geometry.location,title:e.name}),s=new google.maps.InfoWindow({content:'<h4 class="text-center">'+e.name+'</h4><img src="'+o+'" class="img-responsive">'});google.maps.event.addListener(a,"click",function(){s.open(n(),this)})}var a=ko.observable(40.8621822),s=ko.observable(-73.8935974),l=ko.observable(new google.maps.LatLng(a(),s())),n=ko.observable(new google.maps.Map(document.getElementById("mapCanvas"),{center:l(),zoom:17})),t={location:l(),radius:"500",types:["store"]},i=new google.maps.places.PlacesService(n());i.nearbySearch(t,e),model.map=n()},places:ko.observableArray([]),map:ko.observable()},ViewModel=function(){var e=this;e.model={},e.init={},e.map=ko.observable(model.init()),e.places=ko.computed(function(){return model.places()})};ko.applyBindings(new ViewModel);